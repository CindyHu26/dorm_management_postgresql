# views/guide_view.py

import streamlit as st

def render():
    """渲染「系統操作指南」頁面"""
    
    st.markdown("# 📘 宿舍管理系統 - 行政人員操作指南")
    
    st.info("💡 **提示**：點擊左側側邊欄的選單可切換不同功能頁面。本頁面為系統功能速查表。")

    with st.expander("⚠️ 特別提醒：關於系統自動同步 (請務必閱讀)", expanded=True):
        st.warning("""
        以下兩個頁面主要系統已設定每日自動執行更新，**平時請勿手動操作**。
        1.  **移工系統同步 (爬蟲)**：抓取系統的人員資料。
        2.  **財務系統同步 (B04)**：抓取系統的扣款資料。
        """)

    st.markdown("---")

    tab1, tab2, tab3, tab4 = st.tabs(["📊 數據決策", "🏠 宿舍營運", "💰 財務收支", "⚙️ 系統維護"])

    with tab1:
        st.subheader("📊 數據決策儀表板 (看數據、找問題)")
        st.caption("這裡不用輸入資料，主要是用來檢查異常和看統計報表。")
        
        st.markdown("""
        * **系統總覽儀表板**：查看目前總人數、各宿舍住了多少人、基本的統計圖表。
        * **費用基準與異常分析**：查閱宿舍/雇主房租設定🔴 檢查是否有人的房租/水電收費金額跟別人不一樣（抓出收費設定錯誤）。
        * **雇主損益分析**：選定特定雇主，看我們向該雇主收的錢夠不夠付房租水電（算賺賠）。
        * **虧損宿舍分析**：系統自動列出目前賠錢的宿舍，並提供調整建議。
        * **水電用量分析**：檢查是否有水電費暴增的異常帳單（例如漏水或電錶故障）。
        * **宿舍深度分析**：想知道某一棟宿舍的所有細節（房況、收支、設備）時看這裡。
        * **歷史在住查詢**：查詢過去某個時間點，誰住在哪裡（用於回溯舊資料）。
        * **營運優化建議**：系統會自動列出「住在裡面但房租設為 0」的人，提醒你去補設定。
        * **智慧提醒**：顯示即將到期的租約、該做的消防安檢、或是設備保養提醒。
        """)

    with tab2:
        st.subheader("🏠 宿舍與人員營運 (日常管理、派房)")
        st.caption("這是舍監與行政人員最常用的區塊，負責處理人員入住、搬家與基本資料。")
        
        st.markdown("""
        * **人員管理**：查詢員工詳細資料、修改備註、或手動新增「他仲」人員。
        * **地址與房間管理**：新增或修改宿舍地址、建立房間、設定床位數。
        * **空床位查詢**：有新人要來時，用這裡快速尋找哪裡還有空床位。
        * **房間分配 (入住/換宿)**：🟢 **【常用】** 幫「未分配」的人員安排房間，或是處理員工換宿舍。
        * **未分配房間人員總覽**：檢查有沒有人已經在系統名單上，但還沒被安排到具體房間（防漏網之魚）。
        * **進階批次作業**：🔵 **【大量操作用】** 一次幫幾十個人換宿舍、改費用或設定離宿。
        * **歷史紀錄修正**：萬一之前入住日期或房號打錯了，來這裡修正歷史紀錄。
        * **設備資產管理**：登記宿舍裡的冷氣、冰箱、飲水機等設備資料。
        * **庫存物品管理**：管理備品（如床墊、鑰匙、遙控器）的進貨與發放紀錄。
        * **清掃排程管理**：查看與安排宿舍的定期打掃時間。
        * **電水錶號管理**：登記宿舍有哪些電錶、水錶號碼（先有這個才能輸入帳單）。
        * **廠商資料管理**：建立房東、水電師傅、清潔公司的聯絡方式。
        """)

    with tab3:
        st.subheader("💰 財務收支管理 (管錢、輸入帳單)")
        st.caption("會計或行政人員每月輸入費用與設定收費標準的地方。")
        
        st.markdown("""
        * **變動費用 (水電帳單)**：收到台電、台水帳單後，在這裡輸入金額與度數。
        * **錶號費用 (快速輸入)**：如果你手邊有一疊帳單，用這個頁面可以連續快速輸入。
        * **年度/攤銷費用**：輸入一年繳一次的錢（如消防申報費、保險費），系統會自動攤平到每個月。
        * **維修追蹤與費用**：登記東西壞掉的維修進度，以及維修花了多少錢。
        * **長期合約 (房租/網/清潔等)**：設定我們要付給房東的租金合約、網路費等合約。
        * **合約項目總覽**：一次看完所有宿舍的租約狀況。
        * **其他收入管理**：輸入非房租類的收入（例如：販賣機盈餘、冷氣卡儲值、修繕賠償）。
        * **工人房租設定**：設定每位工人的收費標準（房租、水電費要收多少），會影響扣款金額。（目前採聘軒系統自動匯入，聘軒沒新增的資料才從這裡新增)
        """)

    with tab4:
        st.subheader("⚙️ 資料與系統維護 (進階工具)")
        st.caption("通常用於大量資料處理或產出報表。")
        
        st.markdown("""
        * **批次資料匯入**：當資料量很大時（例如剛建置系統），用 Excel 一次匯入宿舍、人員或帳單。
        * **移工系統同步 (爬蟲)**：*(自動執行，勿動)*
        * **財務系統同步 (B04)**：*(自動執行，勿動)*
        * **報表匯出中心**：需要給主管看報表，或需要 Excel 檔做其他用途時，來這裡下載。
        """)